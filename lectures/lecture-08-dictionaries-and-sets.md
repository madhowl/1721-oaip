# Лекция 8: Словари и множества

## Введение

Словари и множества - это две важные структуры данных в Python, которые позволяют эффективно хранить и обрабатывать коллекции элементов. В отличие от списков и кортежей, которые используют числовые индексы, словари используют пары "ключ-значение", а множества хранят уникальные элементы без определенного порядка. В этой лекции мы подробно рассмотрим особенности этих структур, их методы и области применения.

## Основное содержание

### Что такое словари

**Словарь (dict)** - это неупорядоченная коллекция пар "ключ-значение", где каждый ключ связан с определенным значением. Ключи в словаре должны быть уникальными и неизменяемыми (например, строки, числа, кортежи), а значения могут быть любого типа.

```python
# Создание словаря
person = {"имя": "Иван", "возраст": 25, "город": "Москва"}
empty_dict = {}

# Создание словаря с помощью dict()
another_dict = dict(имя="Мария", возраст=30, город="СПб")

# Создание словаря из списка пар
pairs_dict = dict([("a", 1), ("b", 2), ("c", 3)])
```

### Основные операции со словарями

#### Доступ к значениям

```python
person = {"имя": "Иван", "возраст": 25, "город": "Москва"}

# Доступ к значению по ключу
print(person["имя"])        # "Иван"

# Использование get() для безопасного доступа
print(person.get("имя"))    # "Иван"
print(person.get("адрес"))  # None
print(person.get("адрес", "Не указан"))  # "Не указан"
```

#### Добавление и изменение элементов

```python
person = {"имя": "Иван", "возраст": 25}

# Добавление нового элемента
person["город"] = "Москва"

# Изменение существующего элемента
person["возраст"] = 26

# Обновление нескольких элементов
person.update({"адрес": "ул. Ленина, 1", "телефон": "+7-xxx-xxx-xx-xx"})
```

#### Удаление элементов

```python
person = {"имя": "Иван", "возраст": 25, "город": "Москва"}

# Удаление по ключу
del person["возраст"]

# Удаление с возвратом значения
city = person.pop("город")
print(city)  # "Москва"

# Удаление последнего элемента (в Python 3.7+)
last_item = person.popitem()
print(last_item)  # ("имя", "Иван")

# Очистка словаря
person.clear()
```

### Методы словарей

```python
person = {"имя": "Иван", "возраст": 25, "город": "Москва"}

# Получение всех ключей
keys = person.keys()
print(list(keys))  # ["имя", "возраст", "город"]

# Получение всех значений
values = person.values()
print(list(values))  # ["Иван", 25, "Москва"]

# Получение всех пар ключ-значение
items = person.items()
print(list(items))  # [("имя", "Иван"), ("возраст", 25), ("город", "Москва")]

# Проверка наличия ключа
print("имя" in person)  # True
print("адрес" in person)  # False
```

### Вложенные словари

Словари могут содержать другие словари, создавая сложные структуры данных:

```python
company = {
    "название": "TechCorp",
    "сотрудники": {
        "Иванов": {"должность": "разработчик", "зарплата": 100000},
        "Петров": {"должность": "аналитик", "зарплата": 90000}
    },
    "офисы": ["Москва", "СПб", "Новосибирск"]
}

# Доступ к вложенным данным
print(company["сотрудники"]["Иванов"]["зарплата"])  # 100000
```

### Что такое множества

**Множество (set)** - это неупорядоченная коллекция уникальных элементов. Множества не допускают дубликатов и не поддерживают индексацию, но позволяют эффективно выполнять операции объединения, пересечения и разности.

```python
# Создание множества
numbers = {1, 2, 3, 4, 5}
empty_set = set()  # обратите внимание: {} создает пустой словарь!

# Создание множества из списка (удаляет дубликаты)
list_with_duplicates = [1, 2, 2, 3, 3, 4]
unique_numbers = set(list_with_duplicates)  # {1, 2, 3, 4}
```

### Основные операции с множествами

#### Добавление и удаление элементов

```python
fruits = {"яблоко", "банан", "апельсин"}

# Добавление элемента
fruits.add("груша")

# Добавление нескольких элементов
fruits.update(["виноград", "манго"])

# Удаление элемента (ошибка, если элемента нет)
fruits.remove("банан")

# Удаление элемента (без ошибки, если элемента нет)
fruits.discard("киви")

# Удаление и возврат произвольного элемента
removed_fruit = fruits.pop()

# Очистка множества
fruits.clear()
```

#### Операции над множествами

```python
set1 = {1, 2, 3, 4, 5}
set2 = {4, 5, 6, 7, 8}

# Объединение
union_set = set1 | set2           # {1, 2, 3, 4, 5, 6, 7, 8}
union_set_alt = set1.union(set2)  # {1, 2, 3, 4, 5, 6, 7, 8}

# Пересечение
intersection_set = set1 & set2              # {4, 5}
intersection_set_alt = set1.intersection(set2)  # {4, 5}

# Разность
difference_set = set1 - set2        # {1, 2, 3}
difference_set_alt = set1.difference(set2)  # {1, 2, 3}

# Симметрическая разность
sym_diff = set1 ^ set2                    # {1, 2, 3, 6, 7, 8}
sym_diff_alt = set1.symmetric_difference(set2)  # {1, 2, 3, 6, 7, 8}

# Подмножество и надмножество
print({1, 2} <= set1)  # True - {1, 2} является подмножеством set1
print(set1 >= {1, 2})  # True - set1 является надмножеством {1, 2}
```

### Методы множеств

```python
set1 = {1, 2, 3}
set2 = {2, 3, 4}

# Проверка на наличие элементов
print(1 in set1)        # True
print(1 not in set1)    # False

# Проверка на равенство
print({1, 2, 3} == {3, 2, 1})  # True (порядок не важен)

# Копирование множества
copy_set = set1.copy()
```

### Словарные включения и множественные включения

Python поддерживает включения для создания словарей и множеств:

```python
# Словарные включения
squares_dict = {x: x**2 for x in range(1, 6)}
print(squares_dict)  # {1: 1, 2: 4, 3: 9, 4: 16, 5: 25}

# Условия в словарных включениях
even_squares = {x: x**2 for x in range(1, 11) if x % 2 == 0}
print(even_squares)  # {2: 4, 4: 16, 6: 36, 8: 64, 10: 100}

# Множественные включения
squares_set = {x**2 for x in range(1, 6)}
print(squares_set)  # {1, 4, 9, 16, 25}

# Условия в множественных включениях
odd_numbers = {x for x in range(1, 11) if x % 2 == 1}
print(odd_numbers) # {1, 3, 5, 7, 9}
```

### Итерация по словарям и множествам

```python
# Итерация по словарю
person = {"имя": "Иван", "возраст": 25, "город": "Москва"}

# По ключам
for key in person:
    print(key)

# По ключам (явно)
for key in person.keys():
    print(key)

# По значениям
for value in person.values():
    print(value)

# По парам ключ-значение
for key, value in person.items():
    print(f"{key}: {value}")

# Итерация по множеству
fruits = {"яблоко", "банан", "апельсин"}
for fruit in fruits:
    print(fruit)
```

### Когда использовать словари, а когда множества

**Используйте словари, когда:**
- Нужно связать ключи с определенными значениями
- Требуется быстрый доступ к значениям по ключу
- Нужно хранить структурированные данные (например, информацию о пользователе)
- Требуется часто обновлять или изменять значения

**Используйте множества, когда:**
- Нужно хранить уникальные элементы
- Требуется быстро проверить наличие элемента
- Нужно выполнить операции над множествами (объединение, пересечение и т.д.)
- Нужно удалить дубликаты из коллекции

## Практические примеры

### Пример 1: Словарь как база данных студентов

```python
# База данных студентов
students_db = {
    "ИВАНОВ": {
        "имя": "Иван",
        "фамилия": "Иванов",
        "группа": "ИКБО-10-20",
        "оценки": [5, 4, 5, 4, 5],
        "средний_балл": 4.4
    },
    "ПЕТРОВ": {
        "имя": "Петр",
        "фамилия": "Петров",
        "группа": "ИКБО-11-20",
        "оценки": [3, 4, 3, 5, 4],
        "средний_балл": 3.8
    }
}

def add_student(db, surname, name, group, grades):
    """Добавляет студента в базу данных"""
    surname_upper = surname.upper()
    db[surname_upper] = {
        "имя": name,
        "фамилия": surname,
        "группа": group,
        "оценки": grades,
        "средний_балл": sum(grades) / len(grades)
    }

def get_student_info(db, surname):
    """Получает информацию о студенте"""
    return db.get(surname.upper(), "Студент не найден")

def find_students_by_group(db, group):
    """Находит всех студентов в группе"""
    result = []
    for student_info in db.values():
        if student_info["группа"] == group:
            result.append(student_info)
    return result

# Использование функций
add_student(students_db, "Сидоров", "Алексей", "ИКБО-10-20", [5, 5, 5, 5])
print(get_student_info(students_db, "Иванов"))
print(find_students_by_group(students_db, "ИКБО-10-20"))
```

### Пример 2: Множество для анализа данных

```python
def analyze_text(text):
    """Анализирует текст и возвращает статистику"""
    # Преобразование в нижний регистр и разделение на слова
    words = text.lower().split()
    
    # Очистка слов от пунктуации
    import string
    cleaned_words = []
    for word in words:
        cleaned = word.strip(string.punctuation)
        if cleaned:
            cleaned_words.append(cleaned)
    
    # Подсчет уникальных слов
    unique_words = set(cleaned_words)
    
    # Подсчет частоты слов
    word_freq = {}
    for word in cleaned_words:
        word_freq[word] = word_freq.get(word, 0) + 1
    
    return {
        "всего_слов": len(cleaned_words),
        "уникальных_слов": len(unique_words),
        "уникальные_слова": unique_words,
        "частота_слов": word_freq
    }

text = "Python - это мощный язык программирования. Python легко изучать и применять."
stats = analyze_text(text)
print(f"Всего слов: {stats['всего_слов']}")
print(f"Уникальных слов: {stats['уникальных_слов']}")
print(f"Слова, встречающиеся чаще всего: {max(stats['частота_слов'].items(), key=lambda x: x[1])}")
```

### Пример 3: Использование множеств для поиска различий

```python
def compare_lists(list1, list2):
    """Сравнивает два списка и возвращает различия"""
    set1, set2 = set(list1), set(list2)
    
    return {
        "только_в_первом": set1 - set2,
        "только_во_втором": set2 - set1,
        "общие": set1 & set2,
        "все_уникальные": set1 | set2
    }

list_a = [1, 2, 3, 4, 5, 6]
list_b = [4, 5, 6, 7, 8, 9]

comparison = compare_lists(list_a, list_b)
print(f"Только в первом: {comparison['только_в_первом']}")
print(f"Только во втором: {comparison['только_во_втором']}")
print(f"Общие: {comparison['общие']}")
```

## Заключение

В этой лекции мы подробно рассмотрели словари и множества в Python:

1. **Словари** - коллекции пар "ключ-значение", обеспечивающие быстрый доступ к данным по ключу
2. **Множества** - коллекции уникальных элементов, позволяющие эффективно выполнять операции над множествами
3. **Основные операции** - добавление, удаление, изменение элементов
4. **Методы** - для работы с ключами, значениями, парами и выполнения операций над множествами
5. **Включения** - для удобного создания словарей и множеств
6. **Практическое применение** - в задачах анализа данных, хранения информации и других областях

Словари и множества являются важными структурами данных, которые позволяют решать широкий спектр задач эффективно. В следующей лекции мы рассмотрим функции в Python - важнейший элемент структурного программирования.
